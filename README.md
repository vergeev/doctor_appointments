# Doctor Appointments

Инструмент учёта записей пациентов в различные клиники. 

Issue tracker проекта находится [в Trello](https://trello.com/b/6tzcuTog/appointments).

## Настройка

Перед запуском необходимо создать `.env`-файл по образцу, см. `.env.example`.

Далее последовательно выполнить команды:

```bash
pip install -r requirements.txt
python manage.py migrate
python manage.py createsuperuser
python manage.py runserver
```

Админка будет доступна по адресу `127.0.0.1:8000`.

Чтобы создать учётную запись оператора, суперюзеру надо добавить нового пользователя через админку, выставить галочку «Статус персонала» и добавить пользователя в группу «Оператор».

## Инструкция для операторов

### Обработка новой заявки

1. Оператор открывает страницу создания заявки
2. Оператор спрашивает у пациента его ФИО, номер паспорта, номер телефона
    1. Оператор ищет пациента, и, если такой находится, выбирает его.
    2. Если пациент с такими ФИО и номером паспорта не существует, оператор создаёт нового. Номер паспорта указывается без пробелов.
3. Оператор указывает клинику и специальность, которые ему назвал пациент
4. Оператор добавляет один или несколько диапазонов удобного времени для пациента
5. Оператор нажимает «Сохранить».
6. Оператор звонит в клинику. Перед звонком оператор выставляет статус заявки «Обрабатывается». 
    1. Если время удаётся успешно согласовать, полученное от клиники время записывается в поле заявки «Время приёма».
    2. Если время не удаётся успешно согласовать, удобные для поликлиники диапазоны времени записываются в ту же заявку.
7. Самопроверка: если «время приёма» не выставлено, «удобное для клиники время» должно быть выставлено обязательно.
8. Если «удобные для пациента диапазоны» не входят в «удобные для клиники диапазоны», оператор звонит пациенту и предлагает удобные для клиники диапазоны. В ответ от пациента он получает новые удобные диапазоны, которые входят в удобные диапазоны клиники. Если пациент отвечает отказом, то заявка переводится в статус «Пациент отказался»
9. Если «удобные для пациента диапазоны» входят в «удобные для клиники диапазоны», то оператор звонит в клинику и получает «время приёма».
10. Если поле «время приёма» выставлено, оператор уведомляет пациента и переводит статус заявки в «Обработана».

# Отказ от посещения

Оператор находит в списке заявок нужную и переводит её в статус «Пациент отказался».

# Перенос посещения

Оператор находит в списке заявок нужную и переводит её в статус «Пациент отказался». Оператор создаёт новую заявку и повторяет её обработку.
